(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{128:function(e,t,a){e.exports=a(315)},133:function(e,t,a){},139:function(e,t,a){},173:function(e,t){},175:function(e,t){},238:function(e,t){},239:function(e,t){},315:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(119),r=a.n(s),u=(a(133),a(135),a(21)),l=a.n(u),i=a(28),o=a(41),p=a(40),d=a(120),m=a(121),E=a(126),h=a(122),y=a(127),b=a(11),N=(a(139),a(123)),f=new(a.n(N).a)(window.web3.currentProvider),O=new f.eth.Contract([{constant:!0,inputs:[],name:"latestWinner",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"reward",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"commit",type:"bytes32"}],name:"enterCommitment",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[],name:"gameCount",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"finaliseGame",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getPlayers",outputs:[{name:"",type:"address[]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"choice",type:"uint256"},{name:"nounce",type:"uint256"}],name:"reveal",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getRevealed",outputs:[{name:"",type:"bool[2]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"choice",type:"uint256"},{name:"nounce",type:"uint256"}],name:"getKeccack0",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!0,inputs:[],name:"getPlayerCount",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"candidate",type:"address"}],name:"notAlreadyIn",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"requiredValue",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"}],"0xc2ac76f207fefdbc580cb808b130a9d19b01b3ee"),T=a(317),C=a(318),v=a(319),x=a(320),M=a(321),D=a(322),w=a(323),g=a(324),k=a(325),S=a(326),j=a(327),I="...loading",R={NOT_COMMITTED:"Has not picked his/her choice yet",COMMITTED:"Has sent his/her commitment"},A={NOT_REVEALED:"Has not revealed his/her choice yet",REVEALED:"Has revealed his/her choice",PENDING:"Waiting for the other player..."},L={SENDING:"Sending transaction...",SENT:"Transaction sent!",NONE:""},V="Yes",_="No",P="N/A",G=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(E.a)(this,Object(h.a)(t).call(this,e))).newGame=function(e){a.setState({players:[{addr:P,status1:R.NOT_COMMITTED,status2:A.NOT_REVEALED,act:L.NONE},{addr:P,status1:R.NOT_COMMITTED,status2:A.NOT_REVEALED,act:L.NONE}],playerCount:0,canBeFinalised:_,last:e,choice0:0,choice1:0,nounce0:"",nounce1:""})},a.indexToChoice=function(e){return"choice"+e},a.indexToNounce=function(e){return"nounce"+e},a.handleChangeChoice=function(e,t){a.setState(Object(p.a)({},a.indexToChoice(t),e.target.value))},a.handleChangeNounce=function(e,t){a.setState(Object(p.a)({},a.indexToNounce(t),e.target.value))},a.handleChoice=function(e){return a.state[a.indexToChoice(e)]},a.handleNounce=function(e){return a.state[a.indexToNounce(e)]},a.handleSubmit=function(){var e=Object(o.a)(l.a.mark(function e(t,n){var c,s,r,u,o,p;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),e.t0=t,e.next=0===e.t0?4:1===e.t0?6:8;break;case 4:return a.setState({players:[Object(i.a)({},a.state.players[0],{act:L.SENDING}),a.state.players[1]]}),e.abrupt("break",8);case 6:return a.setState({players:[a.state.players[0],Object(i.a)({},a.state.players[1],{act:L.SENDING})]}),e.abrupt("break",8);case 8:return e.next=11,f.eth.getAccounts();case 11:return c=e.sent,s=0===t?a.state.choice0:a.state.choice1,r=0===t?a.state.nounce0:a.state.nounce1,u=f.utils.soliditySha3(s,r),e.next=17,O.methods.enterCommitment(u).send({from:c[0],value:1e3});case 17:o=0===t?[Object(i.a)({},a.state.players[0],{addr:c[0],act:L.SENT,status1:R.COMMITTED}),a.state.players[1]]:[a.state.players[0],Object(i.a)({},a.state.players[1],{addr:c[0],act:L.SENT,status1:R.COMMITTED})],p=a.state.playerCount+1,a.setState({players:o,playerCount:p});case 20:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleReveal=function(){var e=Object(o.a)(l.a.mark(function e(t,n){var c,s,r,u,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),e.t0=t,e.next=0===e.t0?4:1===e.t0?6:8;break;case 4:return a.setState({players:[Object(i.a)({},a.state.players[0],{act:L.SENDING}),a.state.players[1]]}),e.abrupt("break",8);case 6:return a.setState({players:[a.state.players[0],Object(i.a)({},a.state.players[1],{act:L.SENDING})]}),e.abrupt("break",8);case 8:return e.next=11,f.eth.getAccounts();case 11:return c=e.sent,s=0===t?a.state.choice0:a.state.choice1,r=0===t?a.state.nounce0:a.state.nounce1,e.next=16,O.methods.reveal(s,r).send({from:c[0]});case 16:u=0===t?[{addr:c[0],act:L.SENT,status2:A.REVEALED},a.state.players[1]]:[a.state.players[0],{addr:c[0],act:L.SENT,status2:A.REVEALED}],o=a.state.players[0].status2===A.REVEALED&&a.state.players[1].status2===A.REVEALED?V:_,a.setState({players:u,canBeFinalised:o});case 19:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleFinalSubmit=Object(o.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.eth.getAccounts();case 2:return t=e.sent,e.next=5,O.methods.finaliseGame().send({from:t[0]});case 5:return e.next=7,O.methods.latestWinner().call();case 7:"0x0000000000000000000000000000000000000000"===(n=e.sent)?a.newGame("draw"):a.newGame(n);case 9:case"end":return e.stop()}},e,this)})),a.state={players:[{addr:I,status1:I,status2:I,act:I},{addr:I,status1:I,status2:I,act:I}],playerCount:0,canBeFinalised:I,last:I,choice0:0,choice1:0,nounce0:0,nounce1:0},a.handleChangeChoice=a.handleChangeChoice.bind(Object(b.a)(Object(b.a)(a))),a.handleChangeNounce=a.handleChangeNounce.bind(Object(b.a)(Object(b.a)(a))),a.handleChoice=a.handleChoice.bind(Object(b.a)(Object(b.a)(a))),a.handleNounce=a.handleNounce.bind(Object(b.a)(Object(b.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(b.a)(Object(b.a)(a))),a.handleFinalSubmit=a.handleFinalSubmit.bind(Object(b.a)(Object(b.a)(a))),a.newGame=a.newGame.bind(Object(b.a)(Object(b.a)(a))),a}return Object(y.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(o.a)(l.a.mark(function e(){var t,a,n,c,s,r,u,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=_,e.next=3,O.methods.latestWinner().call();case 3:return a=e.sent,e.t0=parseInt,e.next=7,O.methods.gameCount().call();case 7:return e.t1=e.sent,n=(0,e.t0)(e.t1),c="game not played yet",0!==n&&(c="0x0000000000000000000000000000000000000000"===a?"draw":a),e.t2=parseInt,e.next=15,O.methods.getPlayerCount().call();case 15:return e.t3=e.sent,s=(0,e.t2)(e.t3),e.next=19,O.methods.getPlayers().call();case 19:r=e.sent,u=[],e.t4=s,e.next=0===e.t4?24:1===e.t4?27:2===e.t4?30:35;break;case 24:return u.push({addr:P,status1:R.NOT_COMMITTED,status2:A.NOT_REVEALED,act:L.NONE}),u.push({addr:P,status1:R.NOT_COMMITTED,status2:A.NOT_REVEALED,act:L.NONE}),e.abrupt("break",35);case 27:return u.push({addr:r[0],status1:R.COMMITTED,status2:A.PENDING,act:L.NONE}),u.push({addr:P,status1:R.NOT_COMMITTED,status2:A.NOT_REVEALED,act:L.NONE}),e.abrupt("break",35);case 30:return e.next=32,O.methods.getRevealed().call();case 32:return(i=e.sent)[0]&&i[1]?(u.push({addr:r[0],status1:R.COMMITTED,status2:A.REVEALED,act:L.NONE}),u.push({addr:r[1],status1:R.COMMITTED,status2:A.REVEALED,act:L.NONE}),t=V):i[0]||i[1]?i[0]?(u.push({addr:r[0],status1:R.COMMITTED,status2:A.REVEALED,act:L.NONE}),u.push({addr:r[1],status1:R.COMMITTED,status2:A.NOT_REVEALED,act:L.NONE})):(u.push({addr:r[0],status1:R.COMMITTED,status2:A.NOT_REVEALED,act:L.NONE}),u.push({addr:r[1],status1:R.COMMITTED,status2:A.REVEALED,act:L.NONE})):(u.push({addr:r[0],status1:R.COMMITTED,status2:A.NOT_REVEALED,act:L.NONE}),u.push({addr:r[1],status1:R.COMMITTED,status2:A.NOT_REVEALED,act:L.NONE})),e.abrupt("break",35);case 35:this.setState({players:u,playerCount:s,canBeFinalised:t,last:c});case 37:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=function(){return e.state.canBeFinalised===V?c.a.createElement("p",{className:"lead"},c.a.createElement(T.a,{color:"primary",onClick:function(){return e.handleFinalSubmit()}},"Check winner")):c.a.createElement("div",null)},a=function(t){return c.a.createElement(C.a,{onSubmit:function(a){return e.handleSubmit(t.index,a)}},c.a.createElement(v.a,null,c.a.createElement(x.a,{for:"choice"},"Pick a choice"),c.a.createElement(M.a,{type:"select",id:"choice",name:"choice",value:e.handleChoice(t.index),onChange:function(a){return e.handleChangeChoice(a,t.index)}},c.a.createElement("option",{value:"0"},"Rock"),c.a.createElement("option",{value:"1"},"Paper"),c.a.createElement("option",{value:"2"},"Scissor")),c.a.createElement(x.a,{for:"nounce"},"Pick a secret number"),c.a.createElement(M.a,{type:"text",id:"nounce",name:"nounce",value:e.handleNounce(t.index),onChange:function(a){return e.handleChangeNounce(a,t.index)},placeholder:"your secret number"})),c.a.createElement(T.a,null,"Commit"))},n=function(t){return c.a.createElement(C.a,{onSubmit:function(a){return e.handleReveal(t.index,a)}},c.a.createElement(v.a,null,c.a.createElement(x.a,{for:"choice"},"Pick your choice"),c.a.createElement(M.a,{type:"select",id:"choice",name:"choice",value:e.handleChoice(t.index),onChange:function(a){return e.handleChangeChoice(a,t.index)}},c.a.createElement("option",{value:"0"},"Rock"),c.a.createElement("option",{value:"1"},"Paper"),c.a.createElement("option",{value:"2"},"Scissor")),c.a.createElement(x.a,{for:"nounce"},"Pick your secret number"),c.a.createElement(M.a,{type:"text",id:"nounce",name:"nounce",value:e.handleNounce(t.index),onChange:function(a){return e.handleChangeNounce(a,t.index)},placeholder:"your secret number"})),c.a.createElement(T.a,null,"Reveal"))},s=function(e){return e.player.ac!==L.NONE?c.a.createElement(c.a.Fragment,null," ",e.player.status," "):c.a.createElement(c.a.Fragment,null," ")},r=function(e){return e.player.status1===R.NOT_COMMITTED?c.a.createElement(a,{index:e.index}):c.a.createElement(c.a.Fragment,null,c.a.createElement(D.a,null,e.player.status1),c.a.createElement(D.a,null,"Contract used: ",e.player.addr))},u=function(e){return e.player.status1===R.COMMITTED&&e.player.status2===A.NOT_REVEALED?c.a.createElement(n,{index:e.index}):c.a.createElement(c.a.Fragment,null,c.a.createElement(D.a,null,e.player.status2))},l=function(e){return c.a.createElement(w.a,null,c.a.createElement(g.a,{tag:"h4"},e.name),c.a.createElement("div",null,c.a.createElement(g.a,{tag:"h6"},"Phase 1: Commit"),c.a.createElement(k.a,null,c.a.createElement(r,{index:e.index,player:e.player}))),c.a.createElement("div",null,c.a.createElement(g.a,{tag:"h6"},"Phase 2: Reveal"),c.a.createElement(k.a,null,c.a.createElement(u,{index:e.index,player:e.player}))),c.a.createElement(S.a,{className:"text-muted"},c.a.createElement(s,{index:e.index,player:e.player})))};return c.a.createElement("div",{className:"App"},c.a.createElement("div",{className:"container"},c.a.createElement(function(){return c.a.createElement(j.a,null,c.a.createElement("div",null,c.a.createElement("h1",{className:"display-3"},"Rock Paper Scissor"),c.a.createElement("p",{className:"lead"},"This is a simple rock paper scissor game that uses Ethereum's Rinkeby network. You should have metamask installed and configured on Rinkeby.")),c.a.createElement("hr",{className:"my-2"}),c.a.createElement("div",null,c.a.createElement("h4",null,"Game status"),c.a.createElement("p",null,"Currently ",c.a.createElement("span",{className:"js"},e.state.playerCount)," players have submitted their choice (2 needed to finalise the round)."),c.a.createElement("p",null,"Last game winner: ",e.state.last),c.a.createElement(t,null)),c.a.createElement("hr",{className:"my-2"}),c.a.createElement("div",null,c.a.createElement("h4",null,"Instructions"),c.a.createElement("p",null,"Choose for both Alice and Bob (one after the other) what they should play."),c.a.createElement("p",null,"When the 2 players have sent their choice (button 'Send choice'), you can finalise the game (button 'Check winner' will appear).")))},null),c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-10 col-md-5 m-auto"},c.a.createElement(l,{name:"Alice",index:0,player:this.state.players[0]})),c.a.createElement("div",{className:"col-10 col-md-5 m-auto"},c.a.createElement(l,{name:"Bob",index:1,player:this.state.players[1]})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[128,2,1]]]);
//# sourceMappingURL=main.b2b1bede.chunk.js.map